<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Show do Milh√£o - Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Luckiest Guy', cursive;
      text-align: center;
      background: linear-gradient(120deg, #025935, #011f4b);
      color: white;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .hidden { display: none !important; }

    .container button {
      background-color: #d4aa00;
      border: none;
      padding: 15px 30px;
      margin: 15px;
      font-size: 1.5em;
      font-weight: bold;
      color: #011f4b;
      border-radius: 15px;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.3s;
    }
    .container button:hover { background-color: #ffc800; transform: scale(1.05); }

    /* ---- Tela do jogo ---- */
    #game-screen {
      width: 100vw; 
      height: auto; 
      transition: width 0.3s ease; 
      display: flex;
      flex-direction: row; 
      justify-content: space-between; 
      padding: 45px;
      /* Zoom geral */
      transform: scale(0.84); transform-origin: top center;
    }

    .quiz-area { flex: 2; margin-right: 20px; position: relative; }

    .question-box {
      background-color: #011f4b; 
      padding: 25px; 
      border-radius: 15px; 
      font-size: 1.8em;
      margin-bottom: 30px; 
      border: 4px solid #d4aa00; 
      box-shadow: 0 0 15px #d4aa00;
      text-shadow: 2px 2px 4px black;
    }

    /* Bot√£o tri√¢ngulo para abrir imagem */
    #img-toggle {
      margin: -10px auto 20px auto;
      width: 0; 
      height: 0; 
      cursor: pointer; 
      display: none;
      border-left: 25px solid transparent;
      border-right: 25px solid transparent;
      border-top: 30px solid #ffc800;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.6));
      transition: transform .2s ease, border-top-color .2s ease;
    }
    #img-toggle:hover { transform: scale(1.05); border-top-color: #ffe066; }

    .option-button {
      background-color: #011f4b; 
      border: 3px solid #d4aa00; 
      border-radius: 12px;
      padding: 20px; 
      margin-bottom: 20px; 
      cursor: pointer; 
      font-size: 1.3em; 
      color: white;
      display: flex; 
      align-items: center; 
      transition: background-color 0.3s;
    }

    #question-text, .option-button span, .result { text-shadow: 2px 2px 2px #000; }
    .option-button:hover { background-color: #022b6d; }
    .option-button.disabled { pointer-events: none; opacity: 0.6; }
    .option-label {
      background-color: #d4aa00; 
      color: #011f4b; 
      font-weight: bold; 
      border-radius: 50%;
      width: 45px; 
      height: 45px; 
      display: flex; 
      align-items: center; 
      justify-content: center;
      margin-right: 15px; 
      font-size: 1.3em; 
      box-shadow: 0 0 5px #000;
    }

    .sidebar { 
      flex: none; 
      display: flex; 
      flex-direction: column; 
      align-items: center;
      background-color: rgba(0, 0, 0, 0.3); 
      border-radius: 15px; 
      padding: 10px; 
      max-height: 300px; 
    }

    .sidebar img.avatar { width: 350px; }

    .lifelines { 
      display: flex; 
      flex-direction: row; 
      justify-content: center; 
      align-items: center; 
      gap: 15px; 
      flex-wrap: wrap; 
    }

    .lifelines button { background: none; border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
    .lifelines button.used img { filter: brightness(0.2); pointer-events: none; }
    .lifelines button span { font-size: 0.8em; margin-top: 4px; color: white; }
    #btn-focais img { width: 80px; }
    #btn-lider img { width: 125px; }
    #btn-dica  img { width: 110px; }

    .hearts { display: flex; gap: 50px; margin: 15px 0; background-color: rgba(0,0,0,0.4); padding: 10px; border-radius: 10px; justify-content: center; }
    .hearts span { background-color: gold; color: #011f4b; border-radius: 50%; width: 60px; height: 60px; font-size: 2em; display: flex; align-items: center; justify-content: center; font-weight: bold; box-shadow: 0 0 10px #000; }

    .result { font-size: 1.4em; font-weight: bold; margin-top: 20px; color: #ffeb3b; text-shadow: 1px 1px 2px #000; }
    .correct { background-color: green !important; }

    /* Overlay gen√©rico existente */
    .overlay {
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background-color: rgba(0,0,0,0.9); 
      color: white; 
      display: flex; 
      flex-direction: column;
      justify-content: center; 
      align-items: center; 
      font-size: 1.8em; 
      z-index: 1000;
    }

    .overlay button { margin-top: 20px; padding: 10px 20px; font-size: 1em; }

    .tooltip-btn { position: relative; display: flex; flex-direction: column; align-items: center; }
    .tooltip-text { 
      display: none; 
      position: absolute; 
      bottom: -25px; 
      background-color: rgba(0,0,0,0.8); 
      color: white; 
      padding: 5px 10px; 
      border-radius: 5px; 
      font-size: 0.75em; 
      white-space: nowrap; 
      pointer-events: none; 
      z-index: 10; 
    }

    .tooltip-btn:hover .tooltip-text { display: block; }

    .right-panel { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }
    .maju-container { margin-top: -65px; margin-right: 20px; }
    .avatar-maju { width: 350px; }

    /* === NOVO: Overlay exclusivo da IMAGEM === */
    .img-overlay {
      position: fixed; 
      inset: 0; 
      background: rgba(0,0,0,0.85);
      display: flex; 
      align-items: center; 
      justify-content: center;
      z-index: 2000;
    }

    .img-box {
      position: relative; 
      max-width: 90vw; 
      max-height: 90vh; 
      background: #0b1b3a; 
      border: 4px solid #d4aa00;
      border-radius: 16px; 
      padding: 12px; 
      box-shadow: 0 0 20px rgba(0,0,0,.6);
      display: flex; 
      align-items: center; 
      justify-content: center;
    }

    .img-box img, .img-box iframe, .img-box picture, .img-box video {
      max-width: 88vw; 
      max-height: 82vh; 
      border-radius: 10px; 
      display: block;
    }

    .close-img {
      position: absolute; 
      top: -14px; 
      right: -14px; 
      width: 42px; 
      height: 42px; 
      border-radius: 50%;
      border: 3px solid #d4aa00; 
      background: #ff3b3b; 
      color: #fff; 
      font-weight: bold; 
      font-size: 1.2em;
      cursor: pointer; 
      box-shadow: 0 0 10px rgba(0,0,0,.7);
    }

    .close-img:hover { filter: brightness(1.1); }

  </style>
</head>
<body>
  <audio id="musica" src="Sons/musica.mp3" preload="auto"></audio>
  <audio id="venceu-som" src="Sons/Venceu.mp3" preload="auto"></audio>

    <!-- M√∫sica -->
  <audio id="musica" src="Sons/musica.mp3" preload="auto" loop></audio>

  <!-- Overlay de in√≠cio -->
  <div id="start-overlay" style="
    position:fixed; inset:0;
    background:rgba(0,0,0,0.9);
    color:white; display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    z-index:2000;">
    <button onclick="startGame()" style="
      padding:20px 40px;
      font-size:1.5em;
      border:none;
      border-radius:10px;
      background:#d4aa00;
      cursor:pointer;">Iniciar</button>
  </div>

  <!-- Tela de jogo (j√° inicia direto) -->
  <div class="container" id="game-screen">
    <div class="quiz-area">
      <div class="question-box" id="question-text">Pergunta aqui...</div>
      <div id="img-toggle" title="Abrir imagem da pergunta"></div>
      <div id="options-container"></div>
      <div class="result" id="result-text"></div>
    </div>

    <div class="right-panel">
      <div class="sidebar">
        <div class="lifelines">
          <button id="btn-focais" class="tooltip-btn">
            <img src="Imagens/Pontos Focais.png" alt="Pontos Focais"/>
            <span class="tooltip-text">Pontos Focais</span>
          </button>
          <button id="btn-lider" class="tooltip-btn">
            <img src="Imagens/Lider.png" alt="L√≠der"/>
            <span class="tooltip-text">L√≠der</span>
          </button>
          <button id="btn-dica" class="tooltip-btn">
            <img src="Imagens/Dica de Ouro.png" alt="Dica de Ouro"/>
            <span class="tooltip-text">Dica de Ouro</span>
          </button>
        </div>
        <div class="hearts" id="hearts-container">
          <span>‚ù§Ô∏è</span><span>‚ù§Ô∏è</span><span>‚ù§Ô∏è</span>
        </div>
      </div>
      <div class="maju-container">
        <img src="Imagens/Maju.png" class="avatar-maju" alt="Personagem" />
      </div>
    </div>
  </div>

  <!-- Overlay ajuda / fim de jogo / confirma√ß√£o -->
  <div id="overlay" class="overlay hidden">
    <div id="overlay-content"></div>
    <div id="overlay-buttons"></div>
  </div>

  <!-- NOVO: Overlay de IMAGEM -->
  <div id="image-overlay" class="img-overlay hidden" aria-hidden="true">
    <div class="img-box" role="dialog" aria-modal="true" aria-label="Imagem da Pergunta">
      <button class="close-img" onclick="closeImageOverlay()" aria-label="Fechar">√ó</button>
      <div id="image-content"></div>
    </div>
  </div>

  <script>
    let questions = JSON.parse(localStorage.getItem('customQuestions')) || [
      { question: "Qual √© a capital do Brasil?", options: ["S√£o Paulo", "Rio de Janeiro", "Bras√≠lia", "Salvador"], correct: 2, imageHTML: null },
      { question: "Quanto √© 7 x 8?", options: ["54", "56", "64", "58"], correct: 1, imageHTML: null },
      { question: "Quem pintou a Mona Lisa?", options: ["Van Gogh", "Leonardo da Vinci", "Michelangelo", "Picasso"], correct: 1, imageHTML: null }
    ];

    let currentQuestion = 0;
    let lives = 3;
    let usedFocais = false;
    let usedLider = false;
    let usedDica = false;
    let answered = false;

    // üîπ flag para saber se √© a primeira pergunta
    let primeiraPergunta = true;

    // inicia o jogo automaticamente
    window.addEventListener("load", () => {
      loadQuestion();
    });

    function startGame() {
      document.getElementById("start-overlay").style.display = "none";
      const musica = document.getElementById("musica");
      musica.currentTime = 0;
      musica.play(); // toca musica logo no clique
      loadQuestion(); // carrega a primeira pergunta
    }

    function loadQuestion() {
      const musica = document.getElementById('musica');

      // üîπ s√≥ toca automaticamente se N√ÉO for a primeira pergunta
      if (!primeiraPergunta) {
        musica.currentTime = 0;
        musica.play();
      } else {
        primeiraPergunta = false; // depois da primeira, libera as pr√≥ximas
      }

      answered = false;
      const q = questions[currentQuestion];
      document.getElementById('question-text').innerHTML = q.question;
      const optionsContainer = document.getElementById('options-container');
      document.getElementById('result-text').textContent = "";
      optionsContainer.innerHTML = "";

      const imgToggle = document.getElementById('img-toggle');
      if (q.imageHTML && String(q.imageHTML).trim() !== "") {
        imgToggle.style.display = 'block';
        imgToggle.onclick = openImageOverlay;
      } else {
        imgToggle.style.display = 'none';
        imgToggle.onclick = null;
      }

      const letters = ['A', 'B', 'C', 'D'];
      q.options.forEach((option, index) => {
        const btn = document.createElement("div");
        btn.className = "option-button";
        btn.onclick = () => confirmAnswer(index);

        const label = document.createElement("div");
        label.className = "option-label";
        label.textContent = letters[index];

        const text = document.createElement("span");
        text.textContent = option;

        btn.appendChild(label);
        btn.appendChild(text);
        optionsContainer.appendChild(btn);
      });
    }

    function updateHearts() {
      const hearts = document.getElementById('hearts-container');
      hearts.innerHTML = '';
      for (let i = 0; i < lives; i++) {
        const span = document.createElement('span');
        span.textContent = "‚ù§Ô∏è";
        hearts.appendChild(span);
      }
    }

    function confirmAnswer(index) {
      if (answered) return;
      showOverlay(`<p>Voc√™ tem certeza?</p>`, `<button onclick="closeOverlay();checkAnswer(${index})">Sim</button><button onclick='closeOverlay()'>N√£o</button>`);
    }

    function checkAnswer(index) {
      if (answered) return;
      answered = true;
      const q = questions[currentQuestion];
      const resultText = document.getElementById('result-text');

      document.querySelectorAll('.option-button').forEach((btn, i) => {
        btn.classList.add('disabled');
        if (i === q.correct) btn.classList.add('correct');
      });

      if (index === q.correct) {
        resultText.textContent = "‚úÖ Resposta correta!";
      } else {
        resultText.textContent = `‚ùå Resposta errada! A certa era: ${q.options[q.correct]}`;
        lives--; updateHearts();
        if (lives === 0) { setTimeout(showGameOver, 1000); return; }
      }

      currentQuestion++;
      if (currentQuestion < questions.length) {
        setTimeout(loadQuestion, 2000);
      } else {
        setTimeout(showGameWon, 2000);
      }
    }

    function showOverlay(content, buttons = '<button onclick="closeOverlay()">Fechar</button>') {
      document.getElementById('overlay-content').innerHTML = content;
      document.getElementById('overlay-buttons').innerHTML = buttons;
      document.getElementById('overlay').classList.remove('hidden');
    }
    function closeOverlay() { document.getElementById('overlay').classList.add('hidden'); }

    function showGameOver() { 
        showOverlay(
            `<p>Infelizmente voc√™s perderam!</p>`, 
            `<button onclick="window.location.href='index.html'">Sair</button>`
        ); 
    }

    function showGameWon() {
      const overlay = document.getElementById('overlay');
      const overlayContent = document.getElementById('overlay-content');
      const overlayButtons = document.getElementById('overlay-buttons');

      overlayContent.innerHTML = `
        <div style="animation: glow 1s ease-in-out infinite alternate; font-size: 2em; color: gold;">üèÜ PARAB√âNS!!! üèÜ</div>
        <p style="font-size: 1.5em; margin-top: 20px;">Chegaram at√© o final do nosso Show dos 663 milh√µes!</p>
        <p style="font-size: 1.2em; color: #00ffcc;">Demonstraram muito conhecimento! Voc√™s s√£o verdadeiros campe√µes!</p>`;

      overlayButtons.innerHTML = `<button onclick="window.location.href='index.html'">Sair</button>`;
      overlay.classList.remove('hidden');
      document.getElementById('venceu-som').play();

      const style = document.createElement("style");
      style.textContent = `@keyframes glow { from { text-shadow: 0 0 10px #fff, 0 0 20px #ff0, 0 0 30px #ff0, 0 0 40px #ff8000; } to { text-shadow: 0 0 20px #fff, 0 0 30px #ffff00, 0 0 40px #ffaa00, 0 0 50px #ff8000; } }`;
      document.head.appendChild(style);
    }


    // === PONTOS FOCAIS / L√çDER / DICA (inalterado, com corre√ß√£o do duplicado de focais) ===
    document.getElementById('btn-focais').onclick = () => {
      if (usedFocais) return; usedFocais = true; document.getElementById('btn-focais').classList.add('used');
      const q = questions[currentQuestion]; const totalOptions = q.options.length;
      const focais = ['Anderson', 'Elis', 'Betina'];
      const responses = focais.map(name => {
        const isCorrect = Math.random() < 0.65;
        const answerIndex = isCorrect ? q.correct : getWrongIndex(q.correct, totalOptions);
        return `<li>${name}: ${q.options[answerIndex]}</li>`;
      });
      showOverlay(`Respostas dos Pontos Focais:<ul>${responses.join('')}</ul>`);
    };

    document.getElementById('btn-lider').onclick = () => {
      if (usedLider) return; usedLider = true; document.getElementById('btn-lider').classList.add('used');
      const q = questions[currentQuestion]; const chosenOption = q.options[q.correct];
      showOverlay(`<p>A l√≠der tem certeza que a resposta correta √©:</p><p><strong>${chosenOption}</strong></p>`);
    };

    function getWrongIndex(correctIndex, total) {
      let index; do { index = Math.floor(Math.random() * total); } while (index === correctIndex); return index;
    }

    document.getElementById('btn-dica').onclick = () => {
      if (usedDica) return; usedDica = true; document.getElementById('btn-dica').classList.add('used');
      showOverlay(`
        <p>Vamos jogar cara ou coroa.<br>Se der cara te dou a resposta certa, se der coroa a errada!</p>
        <div id="coin-result" style="font-size: 3em; margin: 20px;">‚ò∫ou‚ôõ</div>
      `, `<button onclick="launchCoin()">Lan√ßar moeda</button>`);
    };

    function launchCoin() {
      const q = questions[currentQuestion];
      const coinResult = Math.random() < 0.5 ? "cara" : "coroa";
      const coinEl = document.getElementById("coin-result");
      if (coinResult === "cara") {
        coinEl.innerHTML = "Cara!<br><small>(Resposta correta)</small>";
        showOverlay(`
          <p>‚ò∫<br>Deu <strong>cara</strong>!<br>A resposta certa √©:</p>
          <p style="font-size: 1.5em;"><strong>${q.options[q.correct]}</strong></p>
        `);
      } else {
        const wrongIndex = getWrongIndex(q.correct, q.options.length);
        coinEl.innerHTML = "Coroa!<br><small>(Dica errada)</small>";
        showOverlay(`
          <p>‚ôõ<br>Deu <strong>coroa</strong>!<br>Aqui vai uma alternativa incorreta:</p>
          <p style="font-size: 1.5em;"><strong>${q.options[wrongIndex]}</strong></p>
        `);
      }
    }

    // === NOVO: abrir/fechar overlay de imagem ===
    function openImageOverlay() {
      const q = questions[currentQuestion];
      const container = document.getElementById('image-content');
      container.innerHTML = '';

      let html = (q.imageHTML || '').trim();
      if (!html) return;

      // Se o usu√°rio colocar apenas um URL, converte para <img>
      const looksLikeURL = /^(https?:\/\/|data:)/i.test(html) && !/[<>]/.test(html);
      if (looksLikeURL) {
        html = `<img src="${html}" alt="Imagem da Pergunta" />`;
      }
      container.innerHTML = html;
      document.getElementById('image-overlay').classList.remove('hidden');
      document.getElementById('image-overlay').setAttribute('aria-hidden', 'false');
    }
    function closeImageOverlay() {
      document.getElementById('image-overlay').classList.add('hidden');
      document.getElementById('image-overlay').setAttribute('aria-hidden', 'true');
      // opcional: limpar conte√∫do para liberar mem√≥ria
      // document.getElementById('image-content').innerHTML = '';
    }

    // Fechar overlay de imagem com ESC ou clique fora
    document.getElementById('image-overlay').addEventListener('click', (e) => {
      if (e.target.id === 'image-overlay') closeImageOverlay();
    });
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeImageOverlay(); });

    function ajustarEscala() {
      const gameScreen = document.getElementById('game-screen');
      if (!gameScreen) return;
      const baseWidth = 1920; const baseHeight = 1080; const escalaCSS = 0.84;
      const scaleX = window.innerWidth / baseWidth; const scaleY = window.innerHeight / baseHeight; const fatorTela = Math.min(scaleX, scaleY);
      const limiteMinimo = 0.80; // mant√©m seu limite
      let escalaFinal; if (fatorTela < 1) { escalaFinal = Math.max(escalaCSS * fatorTela, limiteMinimo); } else { escalaFinal = escalaCSS; }
      gameScreen.style.transform = `scale(${escalaFinal})`; gameScreen.style.transformOrigin = "top center";
    }
    window.addEventListener('resize', ajustarEscala);
    window.addEventListener('load', ajustarEscala);
  </script>
</body>
</html>
